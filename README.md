# Enhanced Disk Export for Lightroom

**Enhanced Disk Export** — это плагин для экспорта в Lightroom Classic, который значительно расширяет стандартные возможности сохранения файлов. Основная идея плагина — предоставить пользователю гибкость настройки путей экспорта с использованием шаблонов (токенов), по аналогии с тем, как это реализовано в **Capture One**.

Плагин заменяет стандартную панель "Export To: Hard Drive" на более мощную версию, позволяя автоматически создавать структуру подпапок на основе метаданных фотографий. Это делает процесс экспорта более организованным и автоматизированным.

## Основные возможности

- **Экспорт по шаблонам (Токены)** — формируйте пути экспорта, используя переменные метаданных, такие как `{{catalog}}/{{image yyyy}}/{{rating}}`.
- **Принцип Capture One** — динамическое создание поддиректорий на лету на основе свойств каждой конкретной фотографии.
- **Гибкая обработка конфликтов** — выбор действия при обнаружении файла с таким же именем: спросить пользователя, автоматически переименовать, перезаписать или пропустить.
- **Расширенная пост-обработка** — автоматическое открытие папки в проводнике/Finder, передача файла стороннему приложению (например, Photoshop или софт для ретуши) или запуск собственного скрипта сразу после экспорта.
- **Интеграция с интерфейсом Lightroom** — использование стандартного прогресс-бара и возможность отмены операции.

## Установка

1. Скопируйте папку `EnhancedDiskExport.lrdevplugin` (или скомпилированную версию `EnhancedDiskExport.lrplugin`) в удобное место на вашем компьютере.
2. В Lightroom Classic выберите `File` → `Plug-in Manager…`.
3. Нажмите `Add` и выберите папку с плагином.
4. В окне экспорта (`File` → `Export…`) выберите **Enhanced Disk Export** в списке сервисов (Export To) в левой верхней части окна.

## Использование и токены

Работа с путями в плагине построена на использовании "токенов" — специальных заполнителей в двойных фигурных скобках. При экспорте плагин заменяет их на реальные значения из метаданных каждого фото.

### Список доступных токенов

| Токен | Описание |
| ----- | ----------- |
| `{{catalog}}`, `{{catalog name}}` | Имя активного каталога. |
| `{{date}}`, `{{yyyy}}`, `{{mm}}`, `{{dd}}` | Текущая дата (время экспорта). |
| `{{image date}}`, `{{image yyyy}}`, `{{image mm}}`, `{{image dd}}` | Дата съемки из метаданных фото. |
| `{{orientation}}` | Ориентация: "Portrait", "Landscape" или "Square" (с учетом кадрирования). |
| `{{folder}}` | Имя исходной папки, в которой находится фото. |
| `{{rating}}` | Рейтинг фотографии (0–5 звезд). |
| `{{color}}` | Цветовая метка (или `nocolor`). |

## Обработка существующих файлов

Плагин позволяет выбрать, что делать, если в целевой папке уже есть файл с таким же именем:
- **Ask what to do** — запрашивать действие для каждого случая (можно выбрать переименование, перезапись или пропуск).
- **Choose a new name** — автоматически добавлять порядковый номер (`_2`, `_3`, ...) до тех пор, пока имя не станет уникальным.
- **Overwrite WITHOUT WARNING** — мгновенно перезаписывать файлы (опасно!).
- **Skip** — пропускать экспорт, если файл уже существует.

## Лицензия

Этот проект распространяется по лицензии **GPLv3**. Подробности в файле [LICENSE](./LICENSE).
